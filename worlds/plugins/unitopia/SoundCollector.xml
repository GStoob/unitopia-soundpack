<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Samstag, Februar 05, 2022, 4:20 PM -->
<!-- MuClient version 5.05 -->

<!-- Plugin "soundcollector" generated by Plugin Wizard -->

<muclient>
<plugin
   name="soundcollector"
   author="FrankieT"
   id="77b62614f17d81ab5707338e"
   language="Lua"
   purpose="Hilfe fuer das Sammeln von Sounds in UNItopia"
   save_state="n"
   date_written="2022-02-05 16:20:23"
   requires="5.05"
   version="1.0"
   >

</plugin>


<!--  Get our standard constants -->

<include name="constants.lua"/>

<!--  Aliases  -->

<aliases>
  <alias
   match="^//sc start$"
   enabled="y"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>Start()</send>
  </alias>
</aliases>

<!--  Script  -->


<script>
<![CDATA[
JSON_BEGIN = "{"
JSON_END = "}"
TRIGGER_RESPONSE_TEXT = "PlaySound(\\\"{to_be_replaced}\\\")"

TriggerMatchText = nil
IsRegExp = false

function Start()
  AskForTriggerText()

  if TriggerMatchText == nil then
    return
  end

  AskIfTriggerContainsRegExp()

  CreateJson()

  world.Note("Die benoetigten Informationen fuer das Sound-Ereignis befinden sich nun in der Zwischenablage und koennen mit STRG + V eingefuegt werden.")
  world.Note("Du kannst den Entwicklern des Soundpacks die Informationen via Ingame Mail oder via e-mail an info@unitopiasoundpack.ch schicken")
  world.Note("Die Entwickler freuen sich sicher Ã¼ber deine Post!")

  Reset()
end

function AskForTriggerText()
  local matchText = nil
  matchText = utils.inputbox("Gib bitte das Ereignis ein, fuer welches ein Sound abgespielt werden soll. Hinweis: Es funktionieren saemtliche Eingaben, die vom MUSHclient-Trigger System unterstuetzt werden. Escape bricht die Eingabe ab.", "SoundCollector", matchText)

  if matchText ~= nil then
    TriggerMatchText = matchText
  end
end


function AskIfTriggerContainsRegExp()
  local isRegExp = utils.msgbox("Handelt es sich beim eingegebenen Trigger um einen regulaeren Ausdruck? (Anmerkung: Bei Unsicherheit bitte mit nein antworten)", "SoundCollector", "yesno", "?", 1)

  if isRegExp == "yes" then
    IsRegExp = true
  end
end


function CreateJson()
  local jsonBuilder = {}

  jsonBuilder[#jsonBuilder+1] = JSON_BEGIN
  jsonBuilder[#jsonBuilder+1] = "\"matchText\":\"" .. TriggerMatchText .. "\","
  jsonBuilder[#jsonBuilder+1] = "\"responseText\":\"" .. TRIGGER_RESPONSE_TEXT .. "\""

  if IsRegExp then
    jsonBuilder[#jsonBuilder+1] = ",\"isRegExp\":true"
  end
  
  jsonBuilder[#jsonBuilder+1] = JSON_END

  jsonString = table.concat(jsonBuilder)
  SetClipboard(jsonString)
end


function Reset()
  TriggerMatchText = nil
  isRegExp = false
end
]]>
</script>


</muclient>
